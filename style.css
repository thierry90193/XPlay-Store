const supabaseUrl = 'https://djhfewzjkwdxotvrqeby.supabase.co'
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRqaGZld3pqa3dkeG90dnJxZWJ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE5NjMyNjIsImV4cCI6MjA4NzUzOTI2Mn0.LF02af08wrJDh414Y6HqZPQHMCCtRYVts0xc-HFwrq0'

const supabase = window.supabase.createClient(supabaseUrl, supabaseKey)

// CARREGAR JOGOS
async function carregarJogos() {
  const { data, error } = await supabase
    .from('biblioteca')
    .select('*')

  if (error) {
    console.log("ERRO:", error)
    return
  }

  const div = document.getElementById('jogos')
  div.innerHTML = ""

  data.forEach(jogo => {
    div.innerHTML += `
      <div class="game">
        <h2>${jogo.nome}</h2>
        <p>R$ ${jogo.preco}</p>
        <button onclick="comprar('${jogo.nome}', '${jogo.link}')">Comprar</button>
      </div>
    `
  })
}

// COMPRAR
function comprar(nome, link) {
  alert("Comprado: " + nome)

  // muda botÃ£o depois de comprar
  event.target.innerText = "Acessar"
  event.target.onclick = () => {
    window.open(link, '_blank')
  }
}

carregarJogos()
